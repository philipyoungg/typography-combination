!function(t){"use strict";var e={headline:{type:"text",properties:{fontFamily:["Lato","Playfair Display","Fira Sans"],fontSize:["3rem"],fontWeight:["600"],fontStyle:["normal"],textAlign:["left"],textTransform:["none","uppercase"],color:["#333","mediumblue"],lineHeight:["1.2"],marginBottom:["8px"],letterSpacing:["-0.025em"],text:["Guns, Germs, and Steel"]}},subheadline:{type:"text",properties:{fontFamily:["sans-serif"],fontSize:["1rem"],fontWeight:["400"],fontStyle:["italic"],textAlign:["left"],textTransform:["none"],color:["#666"],lineHeight:["1.2"],marginBottom:["1.5rem"],letterSpacing:["0"],text:["by Jared Diamond"]}},description:{type:"text",properties:{fontFamily:["Roboto","Crimson"],fontSize:["1rem"],fontWeight:["400"],fontStyle:["normal"],textAlign:["left"],textTransform:["none"],color:["#333"],lineHeight:["1.5"],marginBottom:["0"],letterSpacing:["0"],text:["In the 1930s, the Annales School in France undertook the study of long-term historical structures by using a synthesis of geography, history, and sociology. Scholars examined the impact of geography, climate, and land use. Although geography had been nearly eliminated as an academic discipline in the United States after the 1960s, several geography-based historical theories were published in the 1990s."]}}},n="ontouchstart"in document.documentElement&&navigator.userAgent.match(/Mobi/),a=t.addIndex(t.forEach),o=t.compose(t.toLower,t.trim),i=t.compose(t.map(t.trim),t.split(",")),p=function(t){return String(t).replace(/,(?=[^\s])/g,", ")},s=t.reduce(t.pipe(t.xprod,t.map(t.unnest)),[[]]),r=t.lift(t.map)(t.compose(t.zipObj,t.keys),t.compose(s,t.values)),c=t.compose(t.values,t.map(t.prop("properties")),t.values),m=t.lift(t.zipObj)(t.keys,t.compose(t.map(r),c)),d=t.memoize(t.compose(r,m)),l=t.compose(t.product,t.map(t.length),t.values,t.prop("properties")),u=t.map(t.compose(t.zipObj(["properties"]),t.of)),v=t.compose(u,t.map(t.map(t.of)),t.filter(t.is(Object))),h={render:{combination:function(e,n){var o=e.state;$("#app").empty(),a(function(a,i){$("#app").append($("<div>").addClass("typography").attr("combination-index",i).on("mouseenter touchstart mouseleave",function(t){n.changeActiveCombinationIndex.apply(this,[e,h,t])}).append($("<div>").addClass("typography-identifier").append($("<p>").addClass("typography-identifier__text").text("Combination "+(i+1))).append($("<p>").addClass("typography-identifier__select").html("iterate this style &rarr;").attr("combination-index",i).css({textDecoration:1===o.totalPermutation?"line-through":""}).on("click",function(t){n.reduceToOneCombination.apply(this,[e,h,t])}))).append($("<div>").addClass("typography__item").append($("<div>").append($.map(t.keys(a),function(t){return $("<p>").attr("component-name",t).css(a[t]).addClass(""+(o.activeComponent===t?"element-on-focus":"")).text(""+a[t].text).on("click",function(t){n.changeActiveComponent.apply(this,[e,h,t])})})))))})(o.combination)},activeCombination:function(e,n){var a=e.state;$(".active-combination").addClass("loaded");var o=t.compose(t.keys,t.head)(a.combination);$(".active-combination").empty(),$(".active-combination").append($.map(o,function(t){var o=l(a.app[t]);return $("<div>").addClass("active-combination__item "+(a.activeComponent===t?"is-active":"")).attr("component-name",t).on("click",function(t){n.changeActiveComponent.apply(this,[e,h,t])}).append($("<p>").addClass("active-combination__identifier").text(t)).append($("<p>").addClass("active-combination__count").text(o+" "+(o>1?"combinations":"combination")))}))},input:function(e,a){var o=e.state,i=150,s=t.compose(t.keys,t.path([o.activeComponent,"properties"]))(o.app);$("#inputs").removeClass("loaded"),o.activeComponent?($("#empty-state").removeClass("loaded"),setTimeout(function(){$("#inputs").empty(),$("#inputs").append($.map(s,function(e){var n=t.path([o.activeComponent,"properties",e])(o.app),a=p(n);return $("<div>").addClass("input-and-label").append($("<label>").text(e.replace(/([A-Z])/g," $1"))).append($(""+("text"===e?"<textarea>":"<input>")).text(""+("text"===e?a:"")).attr("value",""+("text"!==e?a:"")).attr("name",e))})),$("input").selectize({plugins:["remove_button","restore_on_backspace"],persist:!0,create:function(t){return{value:t,text:t}},delimiter:","}),h.update.activeInputItem(e),$("input").on("change",function(t){a.userInput.apply(this,[e,h])}),$("textarea").on("input",function(t){a.userInput.apply(this,[e,h])}),n&&($(".selectize-input > .item").css({transition:"none"}),$(".selectize-input > .item a").css({transition:"none"})),$("#inputs").addClass("loaded")},i)):setTimeout(function(){$("#empty-state").addClass("loaded")},i)}},update:{activeInputItem:function(e){var n=e.state,a=$(".selectize-input > .item"),i=t.compose(t.values,t.path([n.activeCombinationIndex,n.activeComponent]))(n.combination),p=t.forEach(function(t){a.each(function(e,n){var a=$(n).attr("data-value");o(t)===o(a)&&$(n).addClass("active")})});null===n.activeCombinationIndex?a.removeClass("active"):p(i)},activeComponent:function(t){var e=t.state,n=$("#app .typography__item p");n.removeClass("element-on-focus"),n.each(function(t,n){$(n).attr("component-name")===e.activeComponent&&$(n).addClass("element-on-focus")})}}},f={userInput:function(e,n){var a=e.state,o=e.updateState,p=$(this).val(),s=$(this).attr("name"),r="text"===s?t.of(p):i(p),c=t.assocPath(["app",a.activeComponent,"properties",s],r)(a),m=d(c.app),l=t.merge(c,{combination:m,totalPermutation:length(m)});o(l),n.render.activeCombination(e,f),n.render.combination(e,f)},changeActiveComponent:function(t,e,n){var a=t.state,o=t.updateState,i=$(this).attr("component-name");a.activeComponent!==i&&"typography-identifier__select"!==n.target.className&&(o({activeComponent:i}),e.update.activeComponent(t,f),e.render.activeCombination(t,f),e.render.input(t,f)),n.stopPropagation()},changeActiveCombinationIndex:function(t,e,n){var a=$(this).attr("combination-index");t.updateState({activeCombinationIndex:"mouseleave"===n.type?null:a}),e.update.activeInputItem(t,f)},reduceToOneCombination:function(t,e){var n=t.state,a=t.updateState,o=$(this).attr("combination-index");if(n.totalPermutation>1){$("#app").removeClass("loaded"),$("#input-container").removeClass("loaded"),$("#credits").removeClass("loaded");var i=v(n.combination[o]),p=d(i);a({totalPermutation:1,activeCombinationIndex:0,app:i,combination:p}),setTimeout(function(){$("#inputs").removeClass("loaded")},200),setTimeout(function(){e.render.combination(t,f),e.render.activeCombination(t,f),e.render.input(t,f),$("#app").addClass("loaded"),$("#input-container").addClass("loaded"),$("#credits").addClass("loaded")},400)}}},C=d(e),y={state:{app:e,activeComponent:t.compose(t.head,t.keys)(e),combination:C,totalPermutation:t.length(C),activeCombinationIndex:null},updateState:function(e){return y.state=t.merge(y.state,e)}};$(document).ready(function(){t.forEach(function(t){return t(y,f)},t.values(h.render)),$("#input-container").on("touchstart",function(t){f.changeActiveCombinationIndex.apply(this,[y,h,t])}),$("#app").on("click",function(t){f.changeActiveComponent.apply(this,[y,h,t])}),$("#app").addClass("loaded")})}(R);
