"use strict";!function(t){var e={headline:{type:"text",properties:{fontFamily:["Lato","Playfair Display","Fira Sans"],fontSize:["48px"],fontWeight:["700"],fontStyle:["normal"],textAlign:["left"],textTransform:["none"],color:["#333","mediumblue"],lineHeight:["1.2"],marginBottom:["4px"],letterSpacing:["-0.5px"],text:["Guns, Germs, and Steel"]}},subheadline:{type:"text",properties:{fontFamily:["sans-serif"],fontSize:["16px"],fontWeight:["400"],fontStyle:["italic"],textAlign:["left"],textTransform:["none"],color:["#666"],lineHeight:["1.2"],marginBottom:["16px"],letterSpacing:["0"],text:["by Jared Diamond"]}},description:{type:"text",properties:{fontFamily:["Roboto","Crimson"],fontSize:["16px"],fontWeight:["400"],fontStyle:["normal"],textAlign:["left"],textTransform:["none"],color:["#333"],lineHeight:["1.5"],marginBottom:["0"],letterSpacing:["0"],text:["In the 1930s, the Annales School in France undertook the study of long-term historical structures by using a synthesis of geography, history, and sociology. Scholars examined the impact of geography, climate, and land use. Although geography had been nearly eliminated as an academic discipline in the United States after the 1960s, several geography-based historical theories were published in the 1990s."]}}},n=require("Ramda"),a=n.forEach,o=n.addIndex,i=n.compose,p=n.toLower,r=n.trim,s=n.map,c=n.split,m="ontouchstart"in document.documentElement&&navigator.userAgent.match(/Mobi/),l=(o(a),i(p,r)),d=i(s(r),c(",")),u=function(t){return String(t).replace(/,(?=[^\s])/g,", ")},v=t.reduce(t.pipe(t.xprod,t.map(t.unnest)),[[]]),f=t.lift(t.map)(t.compose(t.zipObj,t.keys),t.compose(v,t.values)),h=t.compose(t.values,t.map(t.prop("properties")),t.values),g=t.lift(t.zipObj)(t.keys,t.compose(t.map(f),h)),b=t.memoize(t.compose(f,g)),x=t.compose(t.product,t.map(t.length),t.values,t.prop("properties")),C=t.map(t.compose(t.zipObj(["properties"]),t.of)),y=t.compose(C,t.map(t.map(t.of)),t.filter(t.is(Object))),S={fontFamily:["Lato","Playfair Display","Open Sans","Georgia","Karla","Roboto","Cardo","Abril Fatface","Montserrat","Fira Sans","Crimson","sans-serif","serif"],fontSize:["8px","16px","32px","48px"],fontWeight:["100","400","700","900"],fontStyle:["normal","italic","oblique"],textAlign:["left","center","right"],textTransform:["none","uppercase","lowercase","capitalize"],color:["black","#333","#666","coral","mediumblue"],lineHeight:["1.2","1.3","1.5"],marginBottom:["0","4px","8px","16px","32px","48px"],letterSpacing:["-2px","-1px","-0.5px","0","0.5px","1px","2px"]},I=function(t){return[t,t]},_=t.compose(t.zipObj(["text","value"]),I,t.of),A=t.map(t.map(_)),T=A(S),z={render:{combination:function(e,n){var a=e.state;$("#app").empty().append($.map(a.combination,function(o,i){return $("<div>").addClass("typography").attr("combination-index",i).on("mouseenter touchstart mouseleave",n.changeActiveCombinationIndex.bind(null,e,z)).append($("<div>").addClass("typography-identifier").append($("<p>").addClass("typography-identifier__text").text("Combination "+(i+1))).append($("<p>").addClass("typography-identifier__select").html("iterate this style &rarr;").attr("combination-index",i).css({textDecoration:1===a.totalPermutation?"line-through":""}).on("click",n.reduceToOneCombination.bind(null,e,z)))).append($("<div>").addClass("typography__item").append($("<div>").append($.map(t.keys(o),function(t){return $("<p>").attr("component-name",t).css(o[t]).addClass(""+(a.activeComponent===t?"element-on-focus":"")).text(""+o[t].text).on("click",n.changeActiveComponent.bind(null,e,z))}))))}))},activeCombination:function(e,n){var a=e.state,o=t.compose(t.keys,t.head)(a.combination);$(".active-combination").addClass("loaded").empty().append($.map(o,function(t){var o=x(a.app[t]);return $("<div>").addClass("active-combination__item "+(a.activeComponent===t?"is-active":"")).attr("component-name",t).on("click",n.changeActiveComponent.bind(null,e,z)).append($("<p>").addClass("active-combination__identifier").text(t)).append($("<p>").addClass("active-combination__count").text(o+" "+(o>1?"combinations":"combination")))}))},input:function(e,n){var a=e.state,o=150,i=t.compose(t.keys,t.path([a.activeComponent,"properties"]))(a.app);$("#inputs").removeClass("loaded"),a.activeComponent?($("#empty-state").removeClass("loaded"),setTimeout(function(){$("#inputs").empty(),$("#inputs").append($.map(i,function(e){var n=t.path([a.activeComponent,"properties",e])(a.app),o=u(n);return $("<div>").addClass("input-and-label").append($("<label>").text(e.replace(/([A-Z])/g," $1"))).append($(""+("text"===e?"<textarea>":"<input>")).text(""+("text"===e?o:"")).attr("value",""+("text"!==e?o:"")).attr("name",e))})),$("input").each(function(t,e){var n=$(e).attr("name");$(e).selectize({plugins:["remove_button","restore_on_backspace"],persist:!0,create:function(t){return{value:t,text:t}},delimiter:",",options:T[n],items:a.app[a.activeComponent].properties[n]})}),z.update.activeInputItem(e),$("input").on("change",n.userInput.bind(null,e,z)),$("textarea").on("input",n.userInput.bind(null,e,z)),m&&($(".selectize-input > .item").css({transition:"none"}),$(".selectize-input > .item a").css({transition:"none"})),$("#inputs").addClass("loaded")},o)):setTimeout(function(){$("#empty-state").addClass("loaded")},o)}},update:{activeInputItem:function(e){var n=e.state,a=$(".selectize-input > .item"),o=t.compose(t.values,t.path([n.activeCombinationIndex,n.activeComponent]))(n.combination),i=t.forEach(function(t){a.each(function(e,n){var a=$(n).attr("data-value");l(t)===l(a)&&$(n).addClass("active")})});a.removeClass("active"),null!==n.activeCombinationIndex&&i(o)},activeComponent:function(t){var e=t.state,n=$("#app .typography__item p");n.removeClass("element-on-focus"),n.each(function(t,n){$(n).attr("component-name")===e.activeComponent&&$(n).addClass("element-on-focus")})}}},k={userInput:function(e,n,a){Rx.Observable.fromEvent($("input"),"change").map(function(t){return $(t).attr()});var o=e.state,i=e.updateState,p=$(a.currentTarget).val(),r=$(a.currentTarget).attr("name"),s="text"===r?t.of(p):d(p),c=t.assocPath(["app",o.activeComponent,"properties",r],s)(o),m=b(c.app),l=t.merge(c,{combination:m,totalPermutation:t.length(m)});i(l),n.render.activeCombination(e,k),n.render.combination(e,k)},changeActiveComponent:function(t,e,n){var a=t.state,o=t.updateState,i=$(n.currentTarget).attr("component-name");a.activeComponent!==i&&"typography-identifier__select"!==n.target.className&&(o({activeComponent:i}),e.update.activeComponent(t,k),e.render.activeCombination(t,k),e.render.input(t,k)),n.stopPropagation()},changeActiveCombinationIndex:function(t,e,n){var a=$(n.currentTarget).attr("combination-index");t.updateState({activeCombinationIndex:"mouseleave"===n.type?null:a}),e.update.activeInputItem(t,k)},reduceToOneCombination:function(t,e,n){var a=t.state,o=t.updateState,i=$(n.currentTarget).attr("combination-index");if(a.totalPermutation>1){$("#app").removeClass("loaded"),$("#input-container").removeClass("loaded"),$("#credits").removeClass("loaded");var p=y(a.combination[i]),r=b(p);o({totalPermutation:1,activeCombinationIndex:0,app:p,combination:r}),setTimeout(function(){$("#inputs").removeClass("loaded")},200),setTimeout(function(){e.render.combination(t,k),e.render.activeCombination(t,k),e.render.input(t,k),$("#app").addClass("loaded"),$("#input-container").addClass("loaded"),$("#credits").addClass("loaded")},400)}}},O=b(e),P={state:{app:e,activeComponent:t.compose(t.head,t.keys)(e),combination:O,totalPermutation:t.length(O),activeCombinationIndex:null},updateState:function(e){return P.state=t.merge(P.state,e)}};$(document).ready(function(){t.forEach(function(t){return t(P,k)})(t.values(z.render)),$("#input-container").on("touchstart",k.changeActiveCombinationIndex.bind(null,P,z)),$("#app").on("click",k.changeActiveComponent.bind(null,P,z)),$("#app").addClass("loaded")})}(R);
